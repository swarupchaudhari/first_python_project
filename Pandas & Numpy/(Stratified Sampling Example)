import numpy as np
import pandas as pd
from sklearn.model_selection import StratifiedShuffleSplit

# Example: Create income category column
df["income_cat"] = pd.cut(
    df["income"], 
    bins=[0., 1.5, 3.0, 4.5, 6., np.inf],
    labels=[1, 2, 3, 4, 5]
)

# Stratified split
split = StratifiedShuffleSplit(n_splits=1, test_size=0.2, random_state=42)

for train_index, test_index in split.split(df, df["income_cat"]):
    strat_train_set = df.loc[train_index]
    strat_test_set = df.loc[test_index]

# Drop income_cat column
for set_ in (strat_train_set, strat_test_set):
    set_.drop("income_cat", axis=1, inplace=True)

# Check
print(strat_train_set.head())
print(strat_test_set.head())

set(housing["ocean_proximity"])

{'<1H OCEAN', 'INLAND', 'ISLAND', 'NEAR BAY', 'NEAR OCEAN'}

from sklearn.preprocessing import OrdinalEncoder


housing_cat = housing[["ocean_proximity"]]

ordinal_encoder = OrdinalEncoder()

housing_cat_encoded = ordinal_encoder.fit_transform(housing_cat)


housing_cat_encoded = pd.DataFrame(
    housing_cat_encoded,
    columns=["ocean_proximity"],
    index=housing.index
)

housing_cat_encoded.head()


ordinal_encoder.categories_





from sklearn.preprocessing import OneHotEncoder

onehot_encoder = OneHotEncoder(sparse=False)

housing_cat_onehot = onehot_encoder.fit_transform(housing_cat)


housing_cat_onehot = pd.DataFrame(
    housing_cat_onehot,
    columns=onehot_encoder.get_feature_names_out(["ocean_proximity"]),
    index=housing.index
)

housing_cat_onehot.head()


onehot_encoder.categories_


from sklearn.preprocessing import MinMaxScaler


df_scaled = pd.DataFrame(
    df_scaled,
    columns=housing_num.columns,
    index=housing.index
)

df_scaled.head()


from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()

df_scaled = scaler.fit_transform(housing_num)


df_scaled = pd.DataFrame(
    df_scaled,
    columns=housing_num.columns,
    index=housing.index
)

df_scaled.head()


